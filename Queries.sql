DROP DATABASE IF EXISTS BIOMEDICA;

CREATE DATABASE BIOMEDICA;

USE BIOMEDICA;

CREATE TABLE SEXO
(
    ID           INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE       VARCHAR(15),
    DESCRIPCCION VARCHAR(15)
);

CREATE TABLE TELEFONO
(
    ID     INT AUTO_INCREMENT PRIMARY KEY,
    NUMERO BIGINT
);

CREATE TABLE DOMICILIO
(
    ID           INT AUTO_INCREMENT PRIMARY KEY,
    CALLE        VARCHAR(30),
    ALTURA       INT,
    N_PISO       INT,
    DEPARTAMENTO VARCHAR(15)
);

CREATE TABLE UNIDAD_DE_MEDIDA
(
    ID          INT AUTO_INCREMENT PRIMARY KEY,
    UNIDAD      VARCHAR(10),
    DESCRIPCION VARCHAR(10)
);

CREATE TABLE METODO
(
    ID           INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE       VARCHAR(10),
    DESCRIPCCION VARCHAR(10)
);

CREATE TABLE EXTRACCIONISTA
(
    ID       INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE   VARCHAR(50),
    APELLIDO VARCHAR(50)
);

CREATE TABLE ESTADO_DE_SOLICITUD
(
    ID           INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE       VARCHAR(20),
    DESCRIPCCION VARCHAR(20)
);

CREATE TABLE MEDICO
(
    ID        INT AUTO_INCREMENT PRIMARY KEY,
    MATRICULA INT,
    NOMBRE    VARCHAR(50),
    APELLIDO  VARCHAR(50)
);

CREATE TABLE TIPO_DE_DOCUMENTO
(
    ID          INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE      VARCHAR(15),
    DESCRIPCION VARCHAR(15)
);

CREATE TABLE ESTUDIO
(
    ID                  INT AUTO_INCREMENT PRIMARY KEY,
    DESCRIPCCION        VARCHAR(50),
    LIMITE_INFERIOR     INT,
    LIMITE_SUPERIOR     INT,
    ID_METODO           INT,
    ID_UNIDAD_DE_MEDIDA INT,
    CONSTRAINT `ESTUDIO->METODO` FOREIGN KEY (ID_METODO) REFERENCES METODO (ID),
    CONSTRAINT `ESTUDIO->UNIDAD_DE_MEDIDA` FOREIGN KEY (ID_UNIDAD_DE_MEDIDA) REFERENCES UNIDAD_DE_MEDIDA (ID)
);

CREATE TABLE RESULTADO
(
    ID            INT AUTO_INCREMENT PRIMARY KEY,
    VALOR_HALLADO INT,
    FECHA         DATE,
    ID_ESTUDIO    INT,
    OBSERVACION   INT,
    CONSTRAINT `RESULTADO->ESTUDIO` FOREIGN KEY (ID_ESTUDIO) REFERENCES ESTUDIO (ID)
);

CREATE TABLE MUESTRA
(
    ID                    INT AUTO_INCREMENT PRIMARY KEY,
    DESCRIPCCION          VARCHAR(50),
    FECHA_HORA_EXTRACCION DATE,
    ID_SOLICITUD          INT,
    CONSTRAINT `MUESTRA->RESULTADO` FOREIGN KEY (ID_SOLICITUD) REFERENCES RESULTADO (ID)
);

CREATE TABLE PACIENTE
(
    ID                   INT PRIMARY KEY,
    N_DOCUMENTO          INT,
    NOMBRE               VARCHAR(50),
    APELLIDO             VARCHAR(50),
    ID_SEXO              INT,
    ID_DOMICILIO         INT,
    ID_TELEFONO          INT,
    ID_TIPO_DE_DOCUMENTO INT,
    EMAIL                VARCHAR(100),
    CONSTRAINT `PACIENTE->SEXO` FOREIGN KEY (ID_SEXO) REFERENCES SEXO (ID),
    CONSTRAINT `PACIENTE->DOMICILIO` FOREIGN KEY (ID_DOMICILIO) REFERENCES DOMICILIO (ID),
    CONSTRAINT `PACIENTE->TELEFONO` FOREIGN KEY (ID_TELEFONO) REFERENCES TELEFONO (ID),
    CONSTRAINT `PACIENTE->TIPO_DE_DOCUMENTO` FOREIGN KEY (ID_TIPO_DE_DOCUMENTO) REFERENCES TIPO_DE_DOCUMENTO (ID)
);

CREATE TABLE SOLICITUD
(
    ID                      INT AUTO_INCREMENT PRIMARY KEY,
    RECETA                  VARCHAR(100),
    ID_PACIENTE             INT,
    ID_EXTRACCIONISTA       INT,
    ID_ESTADO               INT,
    ID_MEDICO               INT,
    FECHA_HORA_INICIO       DATETIME,
    FECHA_HORA_FINALIZACION DATETIME,
    CAP                     VARCHAR(8),
    CONSTRAINT `SOLICITUD->PACIENTE` FOREIGN KEY (ID_PACIENTE) REFERENCES PACIENTE (ID),
    CONSTRAINT `SOLICITUD->EXTRACCIONISTA` FOREIGN KEY (ID_EXTRACCIONISTA) REFERENCES EXTRACCIONISTA (ID),
    CONSTRAINT `SOLICITUD->ESTADO` FOREIGN KEY (ID_ESTADO) REFERENCES ESTADO_DE_SOLICITUD (ID),
    CONSTRAINT `SOLICITUD->MEDICO` FOREIGN KEY (ID_MEDICO) REFERENCES MEDICO (ID)
);
